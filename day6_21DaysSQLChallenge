/* Count the number of patients by each service. */
	SELECT service, COUNT(*) AS total_patients
FROM patients
GROUP BY service;

 /*Calculate the average age of patients grouped by service.*/ 
	select service,round(avg(age),2)as average_age
    from patients
    group by service;
    
/* Find the total number of staff members per role.*/
	select role,count(*)as total_staff
    from staff
    group by role;

/*
Question: For each hospital service, calculate the total number of patients admitted, total patients refused, and 
the admission rate (percentage of requests that were admitted). Order by admission rate descending.
*/

SELECT 
    service,
    SUM(patients_admitted) AS total_admitted,
    SUM(patients_refused) AS total_refused,
    ROUND(
        (SUM(patients_admitted) * 100.0 / SUM(patients_request)), 
        2
    ) AS admission_rate_percentage
FROM services_weekly
GROUP BY service
ORDER BY admission_rate_percentage DESC;
