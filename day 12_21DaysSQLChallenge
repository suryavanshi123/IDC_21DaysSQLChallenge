
/* Find all weeks in services_weekly where no special event occurred.*/
	select week,
     coalesce(event, 'No event')as event_status
    from services_weekly;
    
/*Count how many records have null or empty event values.*/

	select count(*)as empty_event
    from services_weekly
    where event is null or event ='none';
    
/*List all services that had at least one week with a special event.*/
	select 
    distinct service
    from services_weekly
    where event is not null and event <>'none';
    
## Today's Challenge:

/*Question: Analyze the event impact by comparing weeks with events vs weeks without events. 
Show: event status ('With Event' or 'No Event'), count of weeks, average patient satisfaction, and average staff morale. 
Order by average patient satisfaction descending.*/

	select 
		case
    when coalesce(event,'')='' then 'no event'
    else 'with event'
    end as event_status,
    count(*)as week_count,
    avg(patient_satisfaction)as avg_patient_satisfaction,
    avg(staff_morale)as avg_staff_morale
    from services_weekly
    group by
		case
        when coalesce(event,'')= '' then 'no event'
        else 'with event'
        end
	order by avg_patient_satisfaction desc;
    
    
