/*Extract the year from all patient arrival dates.*/
	select 
    patient_id,
    arrival_date,
    extract(year from arrival_date)as arrival_year
    from patients;
    
/*Calculate the length of stay for each patient (departure_date - arrival_date).*/
	select
    patient_id,
    service,
    arrival_date,
    departure_date,
    datediff(departure_date , arrival_date) as length_of_stay
    from patients;

/*Find all patients who arrived in a specific month.*/
	select patient_id,
    service,
    arrival_date
    from patients
where extract(month from arrival_date)=4;

### Daily Challenge:

/*Question:** Calculate the average length of stay (in days) for each service, showing only services where the average
 stay is more than 7 days. Also show the count of patients and order by average stay descending.*/
		
			select
            service,
            count(patient_id)as total_patients,
            round(avg(datediff(departure_date,arrival_date)),2)as avg_stay_days
            from patients
            group by service
            having avg(datediff(departure_date,arrival_date))>7
            order by avg_stay_days desc;
            
            
 
